{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import React,{Component}from\"react\";import Avatar from'@material-ui/core/Avatar';import PhotoLibraryIcon from'@material-ui/icons/PhotoLibrary';import TextField from\"@material-ui/core/TextField\";import FancyVideo from\"react-videojs-fancybox\";import Firebase from\"../../firebase/firebase.js\";import{connect}from\"react-redux\";import{withRouter}from\"react-router-dom\";import FileUploader from\"react-firebase-file-uploader\";import emailjs from'@emailjs/browser';import\"./UploadVideoSnippet.css\";var ConnectedUploadSeacherBck=function(_Component){_inherits(ConnectedUploadSeacherBck,_Component);var _super=_createSuper(ConnectedUploadSeacherBck);function ConnectedUploadSeacherBck(){var _this;_classCallCheck(this,ConnectedUploadSeacherBck);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={albumName:\"\",singer:\"\",title:\"\",lyrics:\"\",videoID:\"\",addressID:\"\",isUploading:false,progress:0,downloadURL:\"\",orderId:\"\",errorMsg:\"\"};_this.handleUploadStart=function(){return _this.setState({isUploading:true,progress:0});};_this.handleProgress=function(progress){return _this.setState({progress:progress});};_this.handleUploadError=function(error){_this.setState({isUploading:false,errorMsg:error.message});console.error(error);};_this.handleUploadSuccess=function(filename){var videoURL=\"https://firebasestorage.googleapis.com/v0/b/bhukyskitchen-d7606.appspot.com/o/videoSnippets%2F\"+_this.state.orderId+\".mp4?alt=media&token=844dba51-d9f5-4bf3-9e9b-7fb8b38429a1\";_this.setState({downloadURL:videoURL,avatarOnFile:true});Firebase.updateVideoSnippetURL(_this.state.orderId,videoURL).then(function(){_this.sendEmail(_this.state.orderId);});};return _this;}_createClass(ConnectedUploadSeacherBck,[{key:\"sendEmail\",value:function sendEmail(orderId){var _this2=this;Firebase.getReelOrderById(orderId).then(function(val){var message=\"\\n            We are letting you know that your order: (\"+orderId+\") is ready!\\n\\n            You should be able to see a snippet in the VIDEO SNIPPET section here\\n            here: https://www.bhukyskitchen.com/orders/\"+orderId+\"\\n            \";var templateParams={to_name:val.firstName,from_name:'bhukyskitchen',message:message,recipient_email:val.emailAddress,sender_email:\"jesuyedd@gmail.com\",order_id:orderId};emailjs.send('service_jdguftl','template_z19ojwr',templateParams,'VSKnf4Vspvt3LgOiz').then(function(response){console.log('SUCCESS!',response.status,response.text);_this2.setState({errorMsg:\"video snippet email sent to\"+val.emailAddress});},function(){_this2.setState({errorMsg:error.message});});});}},{key:\"render\",value:function render(){var _this3=this;return React.createElement(\"div\",{className:\"UploadVideoSnippet\"},React.createElement(\"div\",{style:{height:\"100%\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\"}},React.createElement(\"div\",{style:{width:320,padding:30,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",flexDirection:\"column\"}},React.createElement(Avatar,{style:{marginBottom:10}},React.createElement(PhotoLibraryIcon,null)),React.createElement(\"div\",{style:{marginBottom:20,fontSize:24,textAlign:\"center\"}},\" \",\"Upload background image for country\",\" \"),React.createElement(TextField,{value:this.state.orderId,placeholder:\"Enter the order ID here\",onChange:function onChange(e){_this3.setState({orderId:e.target.value});}}),this.state.orderId&&React.createElement(\"form\",null,this.state.isUploading&&React.createElement(\"p\",null,\"Progress: \",this.state.progress),\"updating background image for  -- \",this.state.orderId,\",\",React.createElement(\"label\",{style:{color:'#1a4e8e',padding:10,borderRadius:4,cursor:'pointer'}},React.createElement(\"span\",{className:\"UploadVideoSnippet-image-label\"},\"Update Order's Video Snippet\"),React.createElement(FileUploader,{hidden:true,accept:\"video/*\",filename:this.state.orderId,storageRef:Firebase.storage().ref('videoSnippets/'),onUploadStart:this.handleUploadStart,onUploadError:this.handleUploadError,onUploadSuccess:this.handleUploadSuccess,onProgress:this.handleProgress}))),React.createElement(FancyVideo,{source:this.state.downloadURL?this.state.downloadURL:\"https://firebasestorage.googleapis.com/v0/b/bhukyskitchen-2a524.appspot.com/o/menuVideos%2F45381994989.mp4?alt=media&token=ec45452c-4ba6-4987-a3c2-249938b0b712\",poster:\"https://firebasestorage.googleapis.com/v0/b/bhukyskitchen-2a524.appspot.com/o/menuImages%2Fstew.png?alt=media&token=72db2c09-0ddb-49c1-a555-903b20c380cf\",id:\"sintel3\",fitToView:true}),this.state.errorMsg&&React.createElement(\"span\",{className:\"UploadVideoSnippet-errorMsg\"},this.state.errorMsg))));}}]);return ConnectedUploadSeacherBck;}(Component);var mapStateToProps=function mapStateToProps(state){return{};};var UploadVideoSnippet=withRouter(connect(mapStateToProps)(ConnectedUploadSeacherBck));export default UploadVideoSnippet;","map":{"version":3,"names":["React","Component","Avatar","PhotoLibraryIcon","TextField","FancyVideo","Firebase","connect","withRouter","FileUploader","emailjs","ConnectedUploadSeacherBck","state","albumName","singer","title","lyrics","videoID","addressID","isUploading","progress","downloadURL","orderId","errorMsg","handleUploadStart","setState","handleProgress","handleUploadError","error","message","console","handleUploadSuccess","filename","videoURL","avatarOnFile","updateVideoSnippetURL","then","sendEmail","getReelOrderById","val","templateParams","to_name","firstName","from_name","recipient_email","emailAddress","sender_email","order_id","send","response","log","status","text","height","display","justifyContent","alignItems","width","padding","flexDirection","marginBottom","fontSize","textAlign","e","target","value","color","borderRadius","cursor","storage","ref","mapStateToProps","UploadVideoSnippet"],"sources":["/Users/jdavid/Documents/bhukyskitchen/src/components/UploadVideoSnippet/UploadVideoSnippet.js"],"sourcesContent":["import React, { Component } from \"react\";\nimport Avatar from '@material-ui/core/Avatar';\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary';\nimport TextField from \"@material-ui/core/TextField\";\nimport FancyVideo from \"react-videojs-fancybox\";\nimport Firebase from \"../../firebase/firebase.js\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport FileUploader from \"react-firebase-file-uploader\";\nimport emailjs from '@emailjs/browser'\n\nimport \"./UploadVideoSnippet.css\"\n\nclass ConnectedUploadSeacherBck extends Component {\n\n    state = {\n        albumName: \"\",\n        singer: \"\",\n        title: \"\",\n        lyrics: \"\",\n        videoID: \"\",\n        addressID: \"\",\n        isUploading: false,\n        progress: 0,\n        downloadURL: \"\",\n        orderId: \"\",\n        errorMsg: \"\"\n    };\n\n    handleUploadStart = () => this.setState({ isUploading: true, progress: 0 })\n    handleProgress = progress => this.setState({ progress });\n    handleUploadError = error => {\n        this.setState({ isUploading: false, errorMsg: error.message });\n        console.error(error);\n    };\n\n    handleUploadSuccess = filename => {\n        let videoURL = `https://firebasestorage.googleapis.com/v0/b/bhukyskitchen-d7606.appspot.com/o/videoSnippets%2F${this.state.orderId}.mp4?alt=media&token=844dba51-d9f5-4bf3-9e9b-7fb8b38429a1`\n        this.setState({ downloadURL: videoURL, avatarOnFile: true });\n        Firebase.updateVideoSnippetURL(this.state.orderId, videoURL)\n        .then(() => {\n            this.sendEmail(this.state.orderId)\n        });\n    };\n\n    sendEmail(orderId){\n        Firebase.getReelOrderById(orderId).then((val) => {\n\n            let message =  `\n            We are letting you know that your order: (${orderId}) is ready!\n\n            You should be able to see a snippet in the VIDEO SNIPPET section here\n            here: https://www.bhukyskitchen.com/orders/${orderId}\n            `\n\n            var templateParams = {\n                to_name: val.firstName,\n                from_name: 'bhukyskitchen',\n                message: message,\n                recipient_email: val.emailAddress,\n                sender_email: \"jesuyedd@gmail.com\",\n                order_id: orderId\n            };\n\n            emailjs.send('service_jdguftl', 'template_z19ojwr', templateParams, 'VSKnf4Vspvt3LgOiz')\n            .then( (response) => {\n                console.log('SUCCESS!', response.status, response.text);\n                this.setState({errorMsg: \"video snippet email sent to\" + val.emailAddress})\n            }, () => {\n                this.setState({errorMsg: error.message})\n            });\n        });\n    }\n\n\n    render() {\n        return (\n            <div className=\"UploadVideoSnippet\">\n                <div style={{\n                    height: \"100%\",\n                    display: \"flex\",\n                    justifyContent: \"center\",\n                    alignItems: \"center\",\n                }}>\n                    <div\n                    style={{\n                        width: 320,\n                        padding: 30,\n                        display: \"flex\",\n                        alignItems: \"center\",\n                        justifyContent: \"center\",\n                        flexDirection: \"column\"\n                    }}\n                    >\n                    <Avatar style={{ marginBottom: 10 }}>\n                        <PhotoLibraryIcon />\n                    </Avatar>\n                    <div\n                        style={{\n                        marginBottom: 20,\n                        fontSize: 24,\n                        textAlign: \"center\"\n                        }}\n                    >\n                        {\" \"}\n                        Upload background image for country\n                        {\" \"}\n                    </div>\n                        <TextField\n                            value={this.state.orderId}\n                            placeholder=\"Enter the order ID here\"\n                            onChange={e => {\n                                this.setState({ orderId: e.target.value });\n                            }}\n                        />\n                        {this.state.orderId &&\n                            <form>\n                                {this.state.isUploading && <p>Progress: {this.state.progress}</p>}\n                                updating background image for  -- { this.state.orderId},\n                                <label style={{color: '#1a4e8e', padding: 10, borderRadius: 4, cursor: 'pointer', }}>\n                                    <span className=\"UploadVideoSnippet-image-label\">Update Order's Video Snippet</span>\n                                    <FileUploader\n                                        hidden\n                                        accept=\"video/*\"\n                                        filename={this.state.orderId}\n                                        storageRef={Firebase.storage().ref('videoSnippets/')}\n                                        onUploadStart={this.handleUploadStart}\n                                        onUploadError={this.handleUploadError}\n                                        onUploadSuccess={this.handleUploadSuccess}\n                                        onProgress={this.handleProgress}\n                                    />\n                                </label>\n                            </form>\n                        }\n                        <FancyVideo\n                            source={this.state.downloadURL ? this.state.downloadURL : \"https://firebasestorage.googleapis.com/v0/b/bhukyskitchen-2a524.appspot.com/o/menuVideos%2F45381994989.mp4?alt=media&token=ec45452c-4ba6-4987-a3c2-249938b0b712\"}\n                            poster=\"https://firebasestorage.googleapis.com/v0/b/bhukyskitchen-2a524.appspot.com/o/menuImages%2Fstew.png?alt=media&token=72db2c09-0ddb-49c1-a555-903b20c380cf\"\n                            id={\"sintel3\"}\n                            fitToView={true}\n                        />\n\n                        {this.state.errorMsg &&\n                            <span className=\"UploadVideoSnippet-errorMsg\">{this.state.errorMsg}</span>\n                        }\n                    </div>\n                </div>\n            </div>\n\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {};\n};\n\nconst UploadVideoSnippet = withRouter(connect(mapStateToProps)(ConnectedUploadSeacherBck));\nexport default UploadVideoSnippet;\n\n\n//https://material-ui.com/components/material-icons/#material-icons"],"mappings":"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"},"metadata":{},"sourceType":"module"}